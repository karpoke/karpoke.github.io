<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Nacho Cano" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="2.2.17, apache, cabeceras HTTP, denegación de servicio, dos, mod_headers, mod_rewrite, perl, range, requestheader, script, telnet, hack, " />

<meta property="og:title" content="Denegación de servicio en Apache utilizando la cabecera Range "/>
<meta property="og:url" content="https://karpoke.ignaciocano.com/2011/08/31/denegacion-de-servicio-en-apache-utilizando-la-cabecera-range/" />
<meta property="og:description" content="Una vulnerabilidad descubierta por kingcope permite que los servidores Apache vulnerables sean susceptibles de sufrir una denegación de servicio. La vulnerabilidad se encuentra en el uso de la cabecera Range. Esta cabecera se utiliza para obtener sólo una parte de la página. Si se solicitan varias partes además de pedir …" />
<meta property="og:site_name" content="Karpoke" />
<meta property="og:article:author" content="Nacho Cano" />
<meta property="og:article:published_time" content="2011-08-31T14:19:00+02:00" />
<meta name="twitter:title" content="Denegación de servicio en Apache utilizando la cabecera Range ">
<meta name="twitter:description" content="Una vulnerabilidad descubierta por kingcope permite que los servidores Apache vulnerables sean susceptibles de sufrir una denegación de servicio. La vulnerabilidad se encuentra en el uso de la cabecera Range. Esta cabecera se utiliza para obtener sólo una parte de la página. Si se solicitan varias partes además de pedir …">

        <title>Denegación de servicio en Apache utilizando la cabecera Range  · Karpoke
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/custom.css" media="screen">

        <link href="https://karpoke.ignaciocano.com/feeds/all/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Full RSS Feed" />
        <link href="https://karpoke.ignaciocano.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - RSS Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://karpoke.ignaciocano.com/"><span class=site-name>Karpoke</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://karpoke.ignaciocano.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://karpoke.ignaciocano.com/whoami/">Who am I</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/categorias/">Categories</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/etiquetas/">Tags</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/archivos/">Archives</a></li>
                                <li><form class="navbar-search" action="https://karpoke.ignaciocano.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://karpoke.ignaciocano.com/2011/08/31/denegacion-de-servicio-en-apache-utilizando-la-cabecera-range/">
                Denegación de servicio en Apache utilizando la cabecera Range
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>Una <a href="http://issues.apache.org/bugzilla/show_bug.cgi?id=51714" title="vulnerabilidad descubierta por _kingcope_">vulnerabilidad descubierta por <em>kingcope</em></a> permite que los
servidores Apache vulnerables sean susceptibles de sufrir una denegación
de servicio.</p>
<p>La vulnerabilidad se encuentra en el uso de la cabecera <code>Range</code>. Esta
cabecera se utiliza para obtener sólo una parte de la página. Si se
solicitan varias partes además de pedir que la respuesta se comprima,
mediante la cabecera <code>Accept-Encoding: gzip</code>, se dispara el consumo de
procesador y memoria.</p>
<p>Existe un <a href="http://seclists.org/fulldisclosure/2011/Aug/att-175/killapache_pl.bin" title="_script_"><em>script</em></a> que permite comprobar si el servidor es
vulnerable y, si es el caso, explotar dicha vulnerabilidad.</p>
<p>Para comprobar si un servidor es vulnerable, podemos ejecutar:</p>
<p><code>bash
$ telnet 127.0.0.1 80
HEAD / HTTP/1.1
Host: 127.0.0.1
Range: bytes=0-5
Accept-Encoding: gzip
Connection: close</code></p>
<p>Si la respuesta es un código <code>206 Partial Content</code> el servidor es
vulnerable:</p>
<p><code>bash
HTTP/1.1 206 Partial Content
Date: Wed, 31 Aug 2011 11:52:13 GMT
Server: Apache/2.2.17 (Ubuntu)
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Range: bytes 0-5/20
Content-Length: 6
Connection: close
Content-Type: text/html;charset=UTF-8</code></p>
<h2>Protección</h2>
<p>Si tenemos un servidor vulnerable, podemos adoptar alguna de las
siguientes medidas de protección.</p>
<ul>
<li>
<p>Podemos <a href="http://www.securityartwork.es/2011/08/25/denegacion-de-servicio-en-apache/" title="deshabilitar la cabecera `Range`">deshabilitar la cabecera <code>Range</code></a> mediante la directiva
    <code>RequestHeader</code>, usando el módulo <code>mod_headers</code>:</p>
<p><code>bash
 RequestHeader unset Range</code></p>
</li>
</ul>
<p>» <a href="http://seclists.org/fulldisclosure/2011/Aug/257" title="Limitar el número de intervalos">Limitar el número de intervalos</a> mediante <code>mod_rewrite</code>:</p>
<pre><code>```bash
 RewriteEngine On
RewriteCond %{HTTP:Range} ([0-9]_-[0-9]_)(\s*,\s*[0-9]_-[0-9]_)+
RewriteRule .* - [NS,L,F]
```
</code></pre>
<p>» <a href="http://www.daboweb.com/2011/08/24/vulnerabilidad-0-day-y-ataques-dos-en-apache-2-0-2-2-y-1-3-medidas-para-paliarlo/" title="Deshabilitar el módulo `mod_deflate`">Deshabilitar el módulo <code>mod_deflate</code></a>:</p>
<pre><code>```bash
</code></pre>
<p>$ sudo a2dismod deflate
    ```</p>


            
            
            






            <hr/>
<section>
    <h2>Entradas relacionadas</h2>
<ul class="related-posts-list">
<li><a href="https://karpoke.ignaciocano.com/2011/06/20/identificando-los-plugins-de-wordpress-instalados/" title="Identificando los plugins de WordPress instalados">Identificando los plugins de WordPress instalados</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/08/16/evitando-el-hotlinking/" title="Evitando el hotlinking">Evitando el hotlinking</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/09/11/http-strict-transport-security/" title="HTTP Strict Transport Security">HTTP Strict Transport Security</a></li>
<li><a href="https://karpoke.ignaciocano.com/2012/09/21/comprobar-que-no-tenemos-configurado-apache-como-un-proxy-abierto/" title="Comprobar que no tenemos configurado Apache como un proxy abierto">Comprobar que no tenemos configurado Apache como un proxy abierto</a></li>
<li><a href="https://karpoke.ignaciocano.com/2012/12/15/subdominios-dinamicos-en-un-alojamiento-con-dominio-dinamico-en-ovh/" title="Subdominios dinámicos en un alojamiento con dominio dinámico en OVH">Subdominios dinámicos en un alojamiento con dominio dinámico en OVH</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://karpoke.ignaciocano.com/2011/08/27/ultimos-paquetes-instalados/" title="Previous: Últimos paquetes instalados">Últimos paquetes instalados</a></li>
                <li class="next-article"><a href="https://karpoke.ignaciocano.com/2011/09/11/http-strict-transport-security/" title="Next: HTTP Strict Transport Security">HTTP Strict Transport Security</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2011-08-31T14:19:00+02:00">Aug 31, 2011</time>
            <h4>Category</h4>
            <a class="category-link" href="https://karpoke.ignaciocano.com/categorias/#hack-ref">hack</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#2217-ref">2.2.17
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#apache-ref">apache
                    <span>14</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#cabeceras-http-ref">cabeceras HTTP
                    <span>5</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#denegacion-de-servicio-ref">denegación de servicio
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#dos-ref">dos
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#mod_headers-ref">mod_headers
                    <span>3</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#mod_rewrite-ref">mod_rewrite
                    <span>4</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#perl-ref">perl
                    <span>7</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#range-ref">range
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#requestheader-ref">requestheader
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#script-ref">script
                    <span>27</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#telnet-ref">telnet
                    <span>4</span>
</a></li>
            </ul>
<h4>Contacto</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/karpoke" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="/feeds/all/rss.xml" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </div>
        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        2010-2019 (cc) Contenido bajo licencia <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/es/">Creative Commons Reconocimiento-CompartirIgual</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>