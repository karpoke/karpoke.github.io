<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Nacho Cano" />

        <meta name="description" content="Si tenemos acceso por SSH a otro ordenador, ambos con entorno gráfico, podemos redirigir la pantalla, el teclado y el ratón en ambos sentidos, es decir, podemos conseguir cosas como: » aplicaciones remotas que se muestren en nuestro equipo » aplicaciones remotas que se muestren en el equipo remoto » aplicaciones locales que …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="eog, gnome-screensaver, imagemagick, import, pkill, scp, scrot, ssh, admin, " />

<meta property="og:title" content="Imagen a través de SSH "/>
<meta property="og:url" content="https://karpoke.ignaciocano.com/2011/09/28/imagen-a-traves-de-ssh/" />
<meta property="og:description" content="Si tenemos acceso por SSH a otro ordenador, ambos con entorno gráfico, podemos redirigir la pantalla, el teclado y el ratón en ambos sentidos, es decir, podemos conseguir cosas como: » aplicaciones remotas que se muestren en nuestro equipo » aplicaciones remotas que se muestren en el equipo remoto » aplicaciones locales que …" />
<meta property="og:site_name" content="Karpoke - Just another Pelican blog" />
<meta property="og:article:author" content="Nacho Cano" />
<meta property="og:article:published_time" content="2011-09-28T20:48:00+02:00" />
<meta name="twitter:title" content="Imagen a través de SSH ">
<meta name="twitter:description" content="Si tenemos acceso por SSH a otro ordenador, ambos con entorno gráfico, podemos redirigir la pantalla, el teclado y el ratón en ambos sentidos, es decir, podemos conseguir cosas como: » aplicaciones remotas que se muestren en nuestro equipo » aplicaciones remotas que se muestren en el equipo remoto » aplicaciones locales que …">

        <title>Imagen a través de SSH  · Karpoke - Just another Pelican blog
</title>
        <link href="https://karpoke.ignaciocano.com/feeds/all/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Just another Pelican blog - Full RSS Feed" />
        <link href="https://karpoke.ignaciocano.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Just another Pelican blog - RSS Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://karpoke.ignaciocano.com/"><span class=site-name>Karpoke - Just another Pelican blog</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://karpoke.ignaciocano.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://karpoke.ignaciocano.com/whoami/">Who am I</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/categorias/">Categories</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/etiquetas/">Tags</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/archivos/">Archives</a></li>
                                <li><form class="navbar-search" action="https://karpoke.ignaciocano.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://karpoke.ignaciocano.com/2011/09/28/imagen-a-traves-de-ssh/">
                Imagen a través de SSH
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>Si tenemos acceso por SSH a otro ordenador, ambos con entorno gráfico,
podemos redirigir la pantalla, el teclado y el ratón en ambos sentidos,
es decir, podemos conseguir cosas como:</p>
<p>» <a href="#aplicaciones-remotas-a-servidor-local" title="aplicaciones remotas que se muestren en nuestro equipo">aplicaciones remotas que se muestren en nuestro equipo</a>
» <a href="#aplicaciones-remotas-a-servidor-remoto" title="aplicaciones remotas que se muestren en el equipo remoto">aplicaciones remotas que se muestren en el equipo remoto</a>
» <a href="#aplicaciones-locales-a-servidor-remoto" title="aplicaciones locales que se muestren en el equipo remoto">aplicaciones locales que se muestren en el equipo remoto</a>
» <a href="#captura-escritorio-remoto-a-local" title="recibir una captura de pantalla del equipo remoto">recibir una captura de pantalla del equipo remoto</a>
» <a href="#captura-escritorio-local-a-servidor-remoto" title="enviar una captura de pantalla de nuestro equipo al equipo remoto">enviar una captura de pantalla de nuestro equipo al equipo
    remoto</a>
» <a href="#imagen-servidor-remoto-a-local" title="Mostrar una imagen remota en nuestro equipo">mostrar una imagen remota en nuestro equipo</a>
» <a href="#imagen-local-a-servidor-remoto" title="Mostrar una imagen local en el equipo remoto">mostrar una imagen local en el equipo remoto</a></p>
<p><a name="aplicaciones-remotas-a-servidor-local"></a></p>
<h2>Aplicaciones remotas en el servidor gráfico local</h2>
<p>Si queremos que un programa de un equipo remoto se ejecute en el
servidor gráfico de nuestro equipo, una de las cosas que podemos hacer
es <a href="http://www.guia-ubuntu.org/index.php?title=Servidor_ssh" title="configurar el servidor SSH del equipo remoto">configurar el servidor SSH del equipo remoto</a> para que acepte el
reenvío X11, o <em>X11 Forwarding</em>. De esta forma la conexión va cifrada y,
además, tampoco debemos preocuparnos por el valor de la variable de
entorno <code>DISPLAY</code>. Para que el servidor SSH permita el reenvío X11,
deberemos asegurarnos de que en el archivo de configuración
<code>/etc/ssh/sshd_config</code> aparece lo siguiente:</p>
<pre><code>X11Forwarding yes
</code></pre>
<p>Si no estuviera, lo añadimos y reiniciamos el servicio. Ahora,
iniciaremos una conexión SSH desde el cliente, utilizando el argumento <code>-X</code>
de <code>ssh</code>:</p>
<pre><code>$ ssh -C -X user@remotehost
</code></pre>
<p>El argumento <code>-X</code> permite reenviar el terminal gráfico. Se debe utilizar
con cuidado, tal como lo indican en la página del manual. Un usuario del
equipo remoto que pueda saltarse los permisos de archivo (para la base
de datos de usuarios autorizados del servidor X) podría acceder al
terminal gráfico de nuestro equipo a través de la conexión reenviada. Un
atacante podría realizar acciones como por ejemplo monitorizar las
pulsaciones de teclado. Por este motivo, el reenvío X11 está sujeto a
varias restricciones por defecto según la política de seguridad de X11.
Utilizando el argumento <code>-Y</code> se confía en el equipo remoto y no se llevan a
cabo los controles ni se aplican estas restricciones.</p>
<p>Cuando ejecutemos una aplicación con interfaz gráfica, ésta se abrirá en
nuestro equipo.</p>
<pre><code>remotehost$ xeyes &amp;
</code></pre>
<p><a name="aplicaciones-remotas-a-servidor-remoto"></a></p>
<h2>Aplicaciones remotas en el servidor gráfico remoto</h2>
<p>Si lo que queremos es abrir un programa con interfaz gráfica del equipo
remoto, pero esta vez <a href="http://www.carballude.es/blog/2010/05/02/ejecutar-programas-en-la-pantalla-remota-mediante-ssh/" title="en el servidor gráfico del equipo remoto">en el servidor gráfico del equipo remoto</a>, no
es necesario recurrir al reenvío X11. Lo único que hay que hacer, una
vez iniciada la sesión en el equipo remoto, es modificar el valor de la
variable de entorno <code>DISPLAY</code>:</p>
<pre><code>remotehost$ export DISPLAY=:0
</code></pre>
<p>Cuando lancemos una aplicación con interfaz gráfica instalada en el
equipo remoto, ésta se abrirá en el servidor gráfico del equipo remoto.</p>
<p>En lugar de exportar la variable, podemos definirla únicamente para una
aplicación en concreto:</p>
<pre><code>$ DISPLAY=:0 xterm
</code></pre>
<p><a name="aplicaciones-locales-a-servidor-remoto"></a></p>
<h2>Aplicaciones gráficas locales en el entorno gráfico remoto</h2>
<p>Podemos utilizar lo visto en los dos casos anteriores para conseguir que
una aplicación de nuestro equipo se ejecute en el servidor gráfico
remoto a través de SSH. Necesitaremos tener un servidor SSH corriendo en
nuestro equipo.</p>
<p>Primero, establecemos un túnel inverso entre nuestro equipo y el equipo
remoto. Esto quiere decir que se creará una redirección en el puerto
8000 del equipo remoto al servidor SSH de nuestro equipo.</p>
<pre><code>$ ssh -R 8000:localhost:22 remoteuser@remotehost
</code></pre>
<p>Una vez iniciada esta conexión, modificaremos el valor de la variable
<code>DISPLAY</code> y nos conectaremos al puerto local 8000 que redirige a nuestro
equipo:</p>
<pre><code>remotehost$ DISPLAY=:0 ssh -C -X -p8000 user@localhost
</code></pre>
<p>Cuando hayamos iniciado sesión en nuestro equipo será como tener otro
terminal abierto, sólo que las aplicaciones que ejecutemos en éste se
mostrarán en el equipo remoto.</p>
<p>En esta página podemos encontrar una comparativa del <a href="http://www.vanemery.com/Linux/XoverSSH/X-over-SSH2.html" title="consumo de ancho de banda">consumo de ancho
de banda</a> de diferentes programas a través del túnel seguro.</p>
<p><a name="captura-escritorio-remoto-a-local"></a></p>
<h2>Obtener una captura del escritorio remoto</h2>
<p>Si lo que queremos es hacer una captura del escritorio del equipo
remoto, podemos utilizar el comando <code>import</code>:</p>
<pre><code>$ ssh -C user@remotehost "DISPLAY=:0.0 import -window root -format png -" | display -format png -
</code></pre>
<p>En lugar de visualizarla directamente, podríamos guardarla en el equipo
remoto y luego copiar las capturas con <code>scp</code>.</p>
<p>Otro comando sería <code>scrot</code>, disponible en los repositorios:</p>
<pre><code>$ ssh -C user@remotehost "DISPLAY=:0.0 scrot -z - | display -
</code></pre>
<p>Si está puesto el <a href="https://karpoke.ignaciocano.com/2011/07/28/salvapantallas-con-el-codigo-fuente-del-kernel/" title="protector de pantalla">protector de pantalla</a>, por ejemplo, si la captura
sale en negro, deberemos matar el proceso para poder ver el escritorio.</p>
<pre><code>$ ssh user@remotehost "pkill gnome-screensaver"
</code></pre>
<p><a name="captura-escritorio-local-a-servidor-remoto"></a></p>
<h2>Mostrar una captura de nuestro escritorio en el equipo remoto</h2>
<p>El caso contrario al anterior.</p>
<pre><code>$ import -window root -format png - | ssh -C user@remotehost "DISPLAY=:0.0 display -format png -"
</code></pre>
<p>Otra forma sería guardar la captura en un fichero, enviarlo y luego
abrir una aplicación en el equipo remoto:</p>
<pre><code>$ import -window root -format png screenshot.png
$ scp screenshot.png user@remotehost:~
$ ssh user@remotehost "DISPLAY=:0 eog screenshot.png"
</code></pre>
<p><a name="imagen-servidor-remoto-a-local"></a></p>
<h2>Mostrar imágenes del equipo remoto</h2>
<p>De la misma forma que realizamos una captura, podemos enviarnos una
imagen y visualizarla directamente:</p>
<pre><code>$ ssh -C user@remotehost "cat screenshot.png" | display -format png -
</code></pre>
<p><a name="imagen-local-a-servidor-remoto"></a></p>
<h2>Mostrar imágenes de nuestro equipo en el equipo remoto</h2>
<p>Podemos conseguir que se habrá una aplicación remota que muestre una
imagen de nuestro equipo:</p>
<pre><code>$ cat screenshot.png | ssh -C user@remotehost "DISPLAY=:0 display -format png -"
</code></pre>


             
 
            
            
            







            <hr/>
<section>
    <h2>Entradas relacionadas</h2>
<ul class="related-posts-list">
<li><a href="https://karpoke.ignaciocano.com/2010/10/06/de-pantallas-bloqueadas-capturas-de-pantalla-y-david-hasselhoff/" title="De pantallas bloqueadas, capturas de pantalla y David Hasselhoff">De pantallas bloqueadas, capturas de pantalla y David Hasselhoff</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/03/29/encuentra-las-diferencias-desde-el-terminal/" title="Encuentra las diferencias... desde el terminal">Encuentra las diferencias... desde el terminal</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/08/05/servicio-de-ssh-con-sistema-de-verificacion-en-dos-pasos-de-google-en-ubuntu-natty-narwhal/" title="Servicio de SSH con sistema de verificación en dos pasos de Google en Ubuntu Natty Narwhal">Servicio de SSH con sistema de verificación en dos pasos de Google en Ubuntu Natty Narwhal</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/08/12/utilizar-ssh-para-establecer-un-servidor-proxy-socks/" title="Utilizar SSH para establecer un servidor proxy SOCKS">Utilizar SSH para establecer un servidor proxy SOCKS</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/09/18/fwknop-single-packet-authorization-y-port-knocking/" title="fwknop: Single Packet Authorization y port knocking">fwknop: Single Packet Authorization y port knocking</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://karpoke.ignaciocano.com/2011/09/18/descargar-archivos-de-megaupload-desde-el-terminal-con-plowshare/" title="Previous: Descargar archivos de Megaupload desde el terminal con plowshare">Descargar archivos de Megaupload desde el terminal con plowshare</a></li>
                <li class="next-article"><a href="https://karpoke.ignaciocano.com/2011/09/30/twitter-y-el-rss-de-las-cuentas-de-usuario/" title="Next: Twitter y el RSS de las cuentas de usuario">Twitter y el RSS de las cuentas de usuario</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2011-09-28T20:48:00+02:00">Wed 28 September 2011</time>
            <h4>Category</h4>
            <a class="category-link" href="https://karpoke.ignaciocano.com/categorias/#admin-ref">admin</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#eog-ref">eog
                    <span class="superscript">1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#gnome-screensaver-ref">gnome-screensaver
                    <span class="superscript">1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#imagemagick-ref">imagemagick
                    <span class="superscript">2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#import-ref">import
                    <span class="superscript">2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#pkill-ref">pkill
                    <span class="superscript">1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#scp-ref">scp
                    <span class="superscript">4</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#scrot-ref">scrot
                    <span class="superscript">1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#ssh-ref">ssh
                    <span class="superscript">24</span>
</a></li>
            </ul>
<h4>Contacto</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/karpoke" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="/feeds/all/rss.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        2010-2020 (cc) Contenido bajo licencia <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/es/">Creative Commons Reconocimiento-CompartirIgual</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://karpoke.ignaciocano.com/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>