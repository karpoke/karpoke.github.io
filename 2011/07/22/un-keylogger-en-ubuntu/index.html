<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Nacho Cano" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="apparmor, c, ixkeylog, keylogger, perl, selinux, ubuntu, xinput, hack, " />

<meta property="og:title" content="¿Un keylogger en Ubuntu? "/>
<meta property="og:url" content="https://karpoke.ignaciocano.com/2011/07/22/un-keylogger-en-ubuntu/" />
<meta property="og:description" content="El comando xinput permite configurar y probar dispositivos de entrada para las XWindow. Podemos obtener un listado de los dispositivos de entrada: bash $ xinput list ⎡ Virtual core pointer id=2 [master pointer (3)] ⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)] ⎜ ↳ SynPS/2 Synaptics TouchPad id=15 [slave pointer …" />
<meta property="og:site_name" content="Karpoke" />
<meta property="og:article:author" content="Nacho Cano" />
<meta property="og:article:published_time" content="2011-07-22T04:35:00+02:00" />
<meta name="twitter:title" content="¿Un keylogger en Ubuntu? ">
<meta name="twitter:description" content="El comando xinput permite configurar y probar dispositivos de entrada para las XWindow. Podemos obtener un listado de los dispositivos de entrada: bash $ xinput list ⎡ Virtual core pointer id=2 [master pointer (3)] ⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)] ⎜ ↳ SynPS/2 Synaptics TouchPad id=15 [slave pointer …">

        <title>¿Un keylogger en Ubuntu?  · Karpoke
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/custom.css" media="screen">

        <link href="https://karpoke.ignaciocano.com/feeds/all/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Full RSS Feed" />
        <link href="https://karpoke.ignaciocano.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - RSS Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://karpoke.ignaciocano.com/"><span class=site-name>Karpoke</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://karpoke.ignaciocano.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://karpoke.ignaciocano.com/whoami/">Who am I</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/categorias/">Categories</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/etiquetas/">Tags</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/archivos/">Archives</a></li>
                                <li><form class="navbar-search" action="https://karpoke.ignaciocano.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://karpoke.ignaciocano.com/2011/07/22/un-keylogger-en-ubuntu/">
                ¿Un keylogger en Ubuntu?
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>El comando <code>xinput</code> permite configurar y probar dispositivos de entrada
para las XWindow. Podemos obtener un listado de los dispositivos de
entrada:</p>
<p><code>bash
$ xinput list
⎡ Virtual core pointer                      id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
⎜   ↳ SynPS/2 Synaptics TouchPad                id=15   [slave  pointer  (2)]
⎣ Virtual core keyboard                     id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard               id=5    [slave  keyboard (3)]
    ↳ Power Button                              id=6    [slave  keyboard (3)]
    ↳ Video Bus                                 id=7    [slave  keyboard (3)]
    ↳ Power Button                              id=8    [slave  keyboard (3)]
    ↳ Sleep Button                              id=9    [slave  keyboard (3)]
    ↳ Laptop_Integrated_Webcam_2M               id=10   [slave  keyboard (3)]
    ↳ AT Translated Set 2 keyboard              id=11   [slave  keyboard (3)]
    ↳ Dell WMI hotkeys                          id=13   [slave  keyboard (3)]</code></p>
<p>También podemos obtener más información de algún dispositivo en
concreto, por ejemplo, del teclado, cuyo identificador, en mi caso, es
el 11:</p>
<p><code>bash
$ xinput list --long 11
AT Translated Set 2 keyboard                id=11   [slave  keyboard (3)]
    Reporting 1 classes:
        Class originated from: 11
        Keycodes supported: 248</code></p>
<p>También podemos probar el teclado:</p>
<p><code>bash
$ xinput test 11
key release 36
key press   45
kkey release 45
key press   38
akey release 38
key press   27
rkey release 27
key press   33
pkey release 33
key press   32
okey release 32
key press   45
kkey release 45
key press   26
ekey release 26</code></p>
<p>Y el <em>touchpad</em>:</p>
<p><code>bash
$ xinput test 12
motion a[0]=2565 a[1]=3570
motion a[0]=2568 a[1]=3568
motion a[0]=2571 a[1]=3567
motion a[0]=2573 a[1]=3567
motion a[0]=2575 a[1]=3568</code></p>
<p>Todas las teclas que pulsemos, estemos o no en el terminal, aparecen en
el terminal.</p>
<p><a href="http://ubuntuforums.org/archive/index.php/t-1769484.html" title="Esto se debe a que">Esto se debe a que</a>:</p>
<ul>
<li>XWindows no implementa ningún mecanismo de <a href="http://theinvisiblethings.blogspot.com/2011/04/linux-security-circus-on-gui-isolation.html" title="aislamiento entre aplicaciones">aislamiento entre
    aplicaciones</a> que pertenecen a la misma sesión X y, por tanto, una
    aplicación con acceso a la sesión puede monitorizar las teclas
    pulsadas, o los movimientos de ratón.</li>
<li>En principio, sólo será un problema si algún programa que utilicemos
    está comprometido o es malicioso. Para aprovechar <code>xinput</code> como
    <em>keylogger</em> es necesario tener acceso a la sesión X.</li>
<li>Utilizando <code>AppArmor</code> se puede reducir el riesgo, haciendo más
    difícil instalar un <em>keylogger</em> de forma permanente. Sin embargo, no
    puede evitar que una aplicación registre las pulsaciones de teclado,
    y si ésta tiene acceso a internet, podría enviarlas a un servidor
    remoto.</li>
<li>SELinux podría solucionar el problema. Sin embargo, las extensiones
    XSELinux no se cargan por defecto, no todas tienen una madurez para
    incluirlas en un entorno de producción, ni cuales pueden interferir
    negativamente en otras aplicaciones.</li>
</ul>
<p>Esta <a href="http://answers.launchpad.net/ubuntu/+source/xorg/+question/159596" title="potencial vulnerabilidad">potencial vulnerabilidad</a> podría ser aprovechada, por ejemplo,
por:</p>
<ul>
<li>
<p>este <a href="http://sh.kirsle.net/keylog2" title="_script_ en Perl"><em>script</em> en Perl</a> ^[<a href="#dependencias" title="instalar dependencias para ejecutar el script en Ubuntu">1</a>]^, que hace más sencillo reconocer
    qué teclas se están pulsando:</p>
<p><code>bash
$ perl keylog2.pl
Keyboard ID: 11
Watching `xinput test 11`
k(shift key: 0)
[45] press: k
(shift key: 0)
[45] release: k
a(shift key: 0)
[38] press: a
(shift key: 0)
[38] release: a
r(shift key: 0)
[27] press: r
(shift key: 0)
[27] release: r
p(shift key: 0)
[33] press: p
(shift key: 0)
[33] release: p
o(shift key: 0)
[32] press: o
(shift key: 0)
[32] release: o
k(shift key: 0)
[45] press: k
(shift key: 0)
[45] release: k
e(shift key: 0)
[26] press: e
(shift key: 0)
[26] release: e
[105] press: {Ctrl}
^C</code></p>
</li>
<li>
<p>este <a href="http://pastebin.com/sk7FZ6AP" title="programa en C++">programa en C++</a>,</p>
<p>```bash
$ g++ -lX11 keylogger.cpp -o keylogger
$ ./keylogger
Keylogger started</p>
<p>Info about X11 connection:
 The display is:::0.0
 Width::1680    Height::1050
 Connection number is 3
 You’ve got a coloured monitor with depth of 24</p>
<p>Logging started.</p>
<p>1311301288.99731492996215820312: 36
k1311301290.27069497108459472656: 45
1311301290.30860710144042968750: 45
a1311301290.34145402908325195312: 38
1311301290.37259697914123535156: 38
1311301290.40374803543090820312: 27
1311301290.40377688407897949219: 38
r1311301290.43391704559326171875: 27
1311301290.43394398689270019531: 38
1311301290.46408295631408691406: 27
1311301290.46410894393920898438: 33
p1311301290.49424099922180175781: 27
1311301290.49426794052124023438: 32 33
o1311301290.52452206611633300781: 32 33
k1311301290.55576109886169433594: 32 33
1311301290.55580902099609375000: 45
1311301290.58594703674316406250: 32
1311301290.58597397804260253906: 45
1311301290.61610102653503417969: 45
e1311301290.67649888992309570312: 26
1311301290.71751308441162109375: 26
1311301291.60019397735595703125: 105
^C
```</p>
</li>
<li>
<p>o este proyecto, <a href="http://pastebin.com/sk7FZ6AP" title="programa en C++">iXKeyLog</a>,</p>
</li>
</ul>
<p><a name="dependencias"></a>
<a href="#dependencias" title="instalar dependencias para ejecutar el script en Ubuntu">1</a> El <em>script</em> en Perl utiliza el módulo <code>IO::Pty::Easy</code>, y para poder
probarlo en Ubuntu, no basta con la librería <code>libio-pty-perl</code> que hay en
los respositorios, necesitaremos <a href="https://karpoke.ignaciocano.com/2011/07/22/instalar-modulos-de-cpan-usando-cpan/" title="instalar módulos de CPAN usando CPAN">instalar el módulo de CPAN</a>.</p>


            
            
            






            <hr/>
<section>
    <h2>Entradas relacionadas</h2>
<ul class="related-posts-list">
<li><a href="https://karpoke.ignaciocano.com/2011/03/14/inception/" title="inception">inception</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/07/08/cambiar-la-contrasena-de-administrador-en-mysql-5-1/" title="Cambiar la contraseña de administrador en MySQL 5.1">Cambiar la contraseña de administrador en MySQL 5.1</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/07/30/endianness/" title="Endianness">Endianness</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/08/01/limitando-el-numero-de-procesos-por-usuario/" title="Limitando el número de procesos por usuario">Limitando el número de procesos por usuario</a></li>
<li><a href="https://karpoke.ignaciocano.com/2016/11/01/linux-containers-in-500-lines-of-code/" title="Linux containers in 500 lines of code">Linux containers in 500 lines of code</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://karpoke.ignaciocano.com/2011/07/22/instalar-modulos-de-cpan-usando-cpan/" title="Previous: Instalar módulos de CPAN usando CPAN">Instalar módulos de CPAN usando CPAN</a></li>
                <li class="next-article"><a href="https://karpoke.ignaciocano.com/2011/07/28/salvapantallas-con-el-codigo-fuente-del-kernel/" title="Next: Salvapantallas con el código fuente del kernel">Salvapantallas con el código fuente del kernel</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2011-07-22T04:35:00+02:00">Jul 22, 2011</time>
            <h4>Category</h4>
            <a class="category-link" href="https://karpoke.ignaciocano.com/categorias/#hack-ref">hack</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#apparmor-ref">apparmor
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#c-ref">c
                    <span>7</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#ixkeylog-ref">ixkeylog
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#keylogger-ref">keylogger
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#perl-ref">perl
                    <span>7</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#selinux-ref">selinux
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#ubuntu-ref">ubuntu
                    <span>22</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#xinput-ref">xinput
                    <span>1</span>
</a></li>
            </ul>
<h4>Contacto</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/karpoke" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="/feeds/all/rss.xml" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </div>
        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        2010-2019 (cc) Contenido bajo licencia <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/es/">Creative Commons Reconocimiento-CompartirIgual</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>