<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Nacho Cano" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="10.10, curl, egg, google chart api, imaging, jcc, make, oneliner, pyqrcode, python, qr, qrcode, qrencode, setuptools, ubuntu maverick meerkat, ubuntu one, admin, " />

<meta property="og:title" content="Creando y leyendo códigos QR desde Python "/>
<meta property="og:url" content="https://karpoke.ignaciocano.com/2011/03/27/creando-y-leyendo-codigos-qr-desde-python/" />
<meta property="og:description" content="Un código QR (Quick Response Barcode) permite almacenar información en un código de barras de dos dimensiones. Hay bastantes servicios en la web que nos permiten crear nuestros propios códigos, por ejemplo el de Google, que podemos emplear desde la línea de comandos: bash $ curl http://chart.apis.google.com …" />
<meta property="og:site_name" content="Karpoke" />
<meta property="og:article:author" content="Nacho Cano" />
<meta property="og:article:published_time" content="2011-03-27T19:46:00+02:00" />
<meta name="twitter:title" content="Creando y leyendo códigos QR desde Python ">
<meta name="twitter:description" content="Un código QR (Quick Response Barcode) permite almacenar información en un código de barras de dos dimensiones. Hay bastantes servicios en la web que nos permiten crear nuestros propios códigos, por ejemplo el de Google, que podemos emplear desde la línea de comandos: bash $ curl http://chart.apis.google.com …">

        <title>Creando y leyendo códigos QR desde Python  · Karpoke
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/custom.css" media="screen">

        <link href="https://karpoke.ignaciocano.com/feeds/all/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Full RSS Feed" />
        <link href="https://karpoke.ignaciocano.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - RSS Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://karpoke.ignaciocano.com/"><span class=site-name>Karpoke</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://karpoke.ignaciocano.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://karpoke.ignaciocano.com/whoami/">Who am I</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/categorias/">Categories</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/etiquetas/">Tags</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/archivos/">Archives</a></li>
                                <li><form class="navbar-search" action="https://karpoke.ignaciocano.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://karpoke.ignaciocano.com/2011/03/27/creando-y-leyendo-codigos-qr-desde-python/">
                Creando y leyendo códigos QR desde Python
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>Un código QR (Quick Response Barcode) permite almacenar información en
un código de barras de dos dimensiones.</p>
<p><img alt="cc.qr.code.capacity`" src="https://karpoke.ignaciocano.com/images/cc.qr_.code_.capacity-300x166.jpg" /></p>
<p>Hay bastantes servicios en la web que nos permiten crear nuestros
propios códigos, por ejemplo <a href="http://code.google.com/apis/chart/infographics/docs/qr_codes.html" title="el de Google">el de Google</a>, que podemos emplear desde
la línea de comandos:</p>
<p><code>bash
$ curl http://chart.apis.google.com/chart?chs=150x150&amp;cht=qr&amp;chld=H|0&amp;chl=texto -o qr.png</code></p>
<p><img alt="QR Code Python" src="https://karpoke.ignaciocano.com/images/qrcode-python.png" /></p>
<p>Un pequeño alias para tenerlo siempre a mano:</p>
<p><code>bash
$ alias qrurl='qrurl() { curl http://chart.apis.google.com/chart?chs=150x150&amp;cht=qr&amp;chld=H|0&amp;chl=${@// /%20} -o qr.$(date +%Y%m%d%H%M%S).png; }; qrurl'
$ qrurl una ranita iba caminando</code></p>
<p>Esto creará un fichero con un nombre parecido a <code>qr.20110325161706.png</code>.</p>
<p>Hay un paquete que nos permite hacer esto desde la línea de comandos, es
<code>qrencode</code>:</p>
<p>```bash
$ qrencode
qrencode version 3.1.1
Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi
Usage: qrencode [OPTION]... [STRING]
Encode input data in a QR Code and save as a PNG image.</p>
<p>-h           display this message.
  --help       display the usage of long options.
  -o FILENAME  write PNG image to FILENAME. If '-' is specified, the result
               will be output to standard output. If -S is given, structured
               symbols are written to FILENAME-01.png, FILENAME-02.png, ...;
               if specified, remove a trailing '.png' from FILENAME.
  -s NUMBER    specify the size of dot (pixel). (default=3)
  -l {LMQH}    specify error collectin level from L (lowest) to H (highest).
               (default=L)
  -v NUMBER    specify the version of the symbol. (default=auto)
  -m NUMBER    specify the width of margin. (default=4)
  -S           make structured symbols. Version must be specified.
  -k           assume that the input text contains kanji (shift-jis).
  -c           encode lower-case alphabet characters in 8-bit mode. (default)
  -i           ignore case distinctions and use only upper-case characters.
  -8           encode entire data in 8-bit mode. -k, -c and -i will be ignored.
  -V           display the version number and copyrights of the qrencode.
  [STRING]     input data. If it is not specified, data will be taken from
               standard input.
```</p>
<p>También hay aplicaciones para el móvil, como el Kaywa Reader, pero ahora
vamos a ver cómo podemos crear y leer un código QR desde Python.</p>
<h2>pyqrcode</h2>
<p><code>pyqrcode</code> es una extensión para poder codificar y decodificar códigos
QR en Python. Para la codificación se ha basado en la librería
<code>libqrencode</code> de Fukuchi Kentaro, y para la decodificación utiliza la
librería de <a href="http://qrcode.sourceforge.jp/" title="qrcode">qrcode</a> de Yusuke Yanbe.</p>
<p>Para instalarlo se necesita:</p>
<p><code>bash
$ sudo aptitude install jcc openjdk-6-jdk openjdk-6-jre python-imaging python-setuptools python-dev</code></p>
<p>En su página pone el Java de Sun, pero a mi también me ha ido bien con
el OpenJDK.</p>
<p>Una vez que nos hayamos descargado el código, toca compilarlo:</p>
<p><code>bash
$ tar xvzf pyqrcode-0.2.1.tar.gz
$ cd pyqrcode-0.2.1
$ make</code></p>
<p>Si tenemos una versión de Python superior a la 2.6, nos aparecerá el
siguiente error:</p>
<p><code>bash
python -m jcc --jar qrcode/qrcode.jar  --build
/usr/bin/python: jcc is a package and cannot be directly executed
make: *** [lib] Error 1</code></p>
<p>La <a href="http://sourceforge.net/projects/pyqrcode/forums/forum/886787/topic/3805055" title="solución">solución</a> pasa por cambiar <code>-m jcc</code> por <code>-m jcc.__main__</code> en el
<code>Makefile</code>. Quedaría así:</p>
<p>```bash</p>
<h1>GENERATE=python -m jcc --jar $(LIBFILE)</h1>
<p>GENERATE=python -m jcc.<strong>main</strong> --jar $(LIBFILE)
```</p>
<p>Ahora ya podemos instalarlo:</p>
<p><code>bash
$ sudo make install</code></p>
<p>También podemos crear un binario a partir de la extensión:</p>
<p><code>bash
$ sudo make egg</code></p>
<p>e instalarlo:</p>
<p><code>python
$ cd dist
$ sudo easy_install qrcode-0.2.1-py2.6-linux-i686.egg</code></p>
<p>Para comprobar que está correctamente instalado, podemos hacer la
siguiente prueba:</p>
<p>```python
$ ipython</p>
<blockquote>
<blockquote>
<blockquote>
<p>import qrcode
```</p>
</blockquote>
</blockquote>
</blockquote>
<p>En Ubuntu Maverick Meerkat es posible que nos salga el siguiente
<a href="http://sourceforge.net/projects/pyqrcode/forums/forum/886787/topic/3897537" title="error">error</a>:</p>
<p>```python
In [1]: import qrcode</p>
<hr />
<p>AttributeError                            Traceback (most recent call last)</p>
<p>/home/karpoke/ in ()</p>
<p>/usr/local/lib/python2.6/dist-packages/qrcode-0.2.1-py2.6-linux-i686.egg/qrcode/<strong>init</strong>.py in ()
     19     pass
     20
---&gt; 21 _qrcode._setExceptionTypes(JavaError, InvalidArgsError)
     22
     23 VERSION = "0.2.1"</p>
<p>AttributeError: 'module' object has no attribute '_setExceptionTypes'
```</p>
<p>Después de ver el código que da este error, una posible solución es
comentar la línea del fichero <code>qrcode/__init__.py</code> que da el error.</p>
<p>```python</p>
<h1>_qrcode._setExceptionTypes(JavaError, InvalidArgsError)</h1>
<p>```</p>
<p>Volvemos a generar el huevo y lo volvemos a instalar:</p>
<p><code>bash
$ sudo make egg
$ sudo easy_install qrcode-0.2.1-py2.6-linux-i686.egg</code></p>
<p>Este <a href="http://ubuntuone.com/p/jig/" title="python egg para crear y leer códigos QR">python egg</a> se puede descargar desde el <a href="https://karpoke.ignaciocano.com/2010/10/31/como-publicar-directorios-en-ubuntu-one-y-dropbox/" title="cómo publicar directorios en ubuntu one y dropbox">directorio
público</a>.</p>
<p>Ya podemos hacer una prueba para crear un código QR:</p>
<p><code>python
import sys, qrcode
e = qrcode.Encoder()
image = e.encode('ando con la mirada fija en el cielo', version=3, mode=e.mode.BINARY, eclevel=e.eclevel.H)
image.save('out.png')</code></p>
<p>Para decodificar:</p>
<p><code>python
import sys, qrcode
d = qrcode.Decoder()
print d.result if d.decode("out.png") else "error"</code></p>
<h2>En el terminal</h2>
<p>Para hacer aún más cómoda la decodificación desde el terminal, vamos a
crear un alias, <code>qrdecode</code>:</p>
<p>```bash</p>
<h1>$1 filename</h1>
<p>alias qrdecode='fqrdecode() { python -c "import qrcode;d=qrcode.Decoder();print d.result if d.decode('\''$1'\'') else '\''Error'\''"; }; fqrdecode'
```</p>
<p>Para crear un QR desde la línea de comandos ya tenemos el paquete
<code>qrencode</code> comentado anteriormente.</p>
<p><code>bash
$ qrencode "texto a poner en el código qr" -o out.png
$ qrdecode out.png
texto a poner en el código qr</code></p>
<h2>Usando la webcam</h2>
<p>La biblioteca <code>libdecodeqr</code> contiene un lector de códigos QR usando la
webcam. Para utilizarlo, ejecutamos:</p>
<p><code>bash
$ libdecodeqr-webcam</code></p>


            
            
            






            <hr/>
<section>
    <h2>Entradas relacionadas</h2>
<ul class="related-posts-list">
<li><a href="https://karpoke.ignaciocano.com/2011/01/07/actualizando-ubuntu-a-la-ultima-distribucion-de-forma-remota/" title="Actualizando Ubuntu a la última distribución de forma remota">Actualizando Ubuntu a la última distribución de forma remota</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/01/18/solucion-de-problemas-con-plymouth-y-ati-en-ubuntu-maverick-meerkat/" title="Solución de problemas con Plymouth y ATI en Ubuntu Maverick Meerkat">Solución de problemas con Plymouth y ATI en Ubuntu Maverick Meerkat</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/01/18/personalizando-el-arranque-grafico-en-ubuntu-maverirk-meerkat/" title="Personalizando el arranque gráfico en Ubuntu Maverirk Meerkat">Personalizando el arranque gráfico en Ubuntu Maverirk Meerkat</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/02/21/solucionado-el-error-tcltk-not-found-al-instalar-omnet-en-ubuntu/" title="Solucionado el error &#34;Tcl/Tk not found&#34; al instalar OMNeT++ en Ubuntu">Solucionado el error "Tcl/Tk not found" al instalar OMNeT++ en Ubuntu</a></li>
<li><a href="https://karpoke.ignaciocano.com/2011/03/30/multiples-cuentas-de-dropbox-en-ubuntu-maverick-meerkat/" title="Múltiples cuentas de Dropbox en Ubuntu Maverick Meerkat">Múltiples cuentas de Dropbox en Ubuntu Maverick Meerkat</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://karpoke.ignaciocano.com/2011/03/17/solucionado-el-error-e-problem-with-mergelist-al-actualizar-debian/" title="Previous: Solucionado el error &#34;E: Problem with MergeList&#34; al actualizar Debian">Solucionado el error "E: Problem with MergeList" al actualizar Debian</a></li>
                <li class="next-article"><a href="https://karpoke.ignaciocano.com/2011/03/27/importar-un-volcado-de-datos-en-mysql/" title="Next: Importar un volcado de datos en MySQL">Importar un volcado de datos en MySQL</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2011-03-27T19:46:00+02:00">Mar 27, 2011</time>
            <h4>Category</h4>
            <a class="category-link" href="https://karpoke.ignaciocano.com/categorias/#admin-ref">admin</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#1010-ref">10.10
                    <span>7</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#curl-ref">curl
                    <span>8</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#egg-ref">egg
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#google-chart-api-ref">google chart api
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#imaging-ref">imaging
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#jcc-ref">jcc
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#make-ref">make
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#oneliner-ref">oneliner
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#pyqrcode-ref">pyqrcode
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#python-ref">python
                    <span>21</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#qr-ref">qr
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#qrcode-ref">qrcode
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#qrencode-ref">qrencode
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#setuptools-ref">setuptools
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#ubuntu-maverick-meerkat-ref">ubuntu maverick meerkat
                    <span>6</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#ubuntu-one-ref">ubuntu one
                    <span>4</span>
</a></li>
            </ul>
<h4>Contacto</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/karpoke" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="/feeds/all/rss.xml" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </div>
        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        2010-2019 (cc) Contenido bajo licencia <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/es/">Creative Commons Reconocimiento-CompartirIgual</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>