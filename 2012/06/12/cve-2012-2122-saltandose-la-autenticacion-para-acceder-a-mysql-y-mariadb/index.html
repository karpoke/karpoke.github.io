<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Nacho Cano" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="autenticación, mariadb, mysql, vulnerabilidades, hack, " />

<meta property="og:title" content="CVE 2012-2122, saltándose la autenticación para acceder a MySQL y MariaDB "/>
<meta property="og:url" content="https://karpoke.ignaciocano.com/2012/06/12/cve-2012-2122-saltandose-la-autenticacion-para-acceder-a-mysql-y-mariadb/" />
<meta property="og:description" content="Un fallo descubierto en MariaDB, y que también afecta a MySQL, permite saltarse la autenticación para acceder a la base de datos utilizando cualquier usuario válido, incluido el root, sin importar la contraseña. Cada vez que un usuario se conecta se genera un token SHA aleatorio y se compara con …" />
<meta property="og:site_name" content="Karpoke" />
<meta property="og:article:author" content="Nacho Cano" />
<meta property="og:article:published_time" content="2012-06-12T14:37:00+02:00" />
<meta name="twitter:title" content="CVE 2012-2122, saltándose la autenticación para acceder a MySQL y MariaDB ">
<meta name="twitter:description" content="Un fallo descubierto en MariaDB, y que también afecta a MySQL, permite saltarse la autenticación para acceder a la base de datos utilizando cualquier usuario válido, incluido el root, sin importar la contraseña. Cada vez que un usuario se conecta se genera un token SHA aleatorio y se compara con …">

        <title>CVE 2012-2122, saltándose la autenticación para acceder a MySQL y MariaDB  · Karpoke
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://karpoke.ignaciocano.com/theme/css/custom.css" media="screen">

        <link href="https://karpoke.ignaciocano.com/feeds/all/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - Full RSS Feed" />
        <link href="https://karpoke.ignaciocano.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Karpoke - RSS Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://karpoke.ignaciocano.com/"><span class=site-name>Karpoke</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://karpoke.ignaciocano.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://karpoke.ignaciocano.com/whoami/">Who am I</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/categorias/">Categories</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/etiquetas/">Tags</a></li>
                                <li ><a href="https://karpoke.ignaciocano.com/archivos/">Archives</a></li>
                                <li><form class="navbar-search" action="https://karpoke.ignaciocano.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://karpoke.ignaciocano.com/2012/06/12/cve-2012-2122-saltandose-la-autenticacion-para-acceder-a-mysql-y-mariadb/">
                CVE 2012-2122, saltándose la autenticación para acceder a MySQL y MariaDB
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>Un fallo descubierto en MariaDB, y que también afecta a MySQL, permite
saltarse la autenticación para acceder a la base de datos utilizando
cualquier usuario válido, incluido el root, sin importar la contraseña.
Cada vez que un usuario se conecta se genera un <em>token</em> SHA aleatorio y
se compara con el valor esperado, pero bajo ciertas condiciones el
resultado de esta comparación se considera válido aunque realmente no lo
sea. Dado que el protocolo utiliza cadenas aleatorias, hay una
probabilidad de 1/256 de que esto ocurra.</p>
<p>No todas las versiones son vulnerables:</p>
<ul>
<li>Todas las versiones de MariaDB y MySQL hasta la 5.1.61, 5.2.11,
    5.3.5 y 5.5.22 son vulnerables.</li>
<li>Las versiones de MariaDB desde la 5.1.62, 5.2.12, 5.3.6 y 5.5.23 no
    lo son.</li>
<li>Las versiones de MySQL desde la 5.1.63, 5.5.24 y 5.6.6 no lo son.</li>
</ul>
<h2>Explotación y medidas de protección</h2>
<p>Explotar un sistema vulnerable es tan sencillo como intentar conectarnos
de forma repetida:</p>
<p><code>bash
$ for i in {1..512}; do echo 'select @@version;' | mysql -uroot -ppass -h 127.0.0.1 2&gt;/dev/null &amp;&amp; break; done</code></p>
<p>Ya hay disponibles actualizaciones en los repositorios para las
versiones afectadas.</p>
<hr />
<h4>Actualizado el 13 de junio de 2012</h4>
<p>En hispasec amplían la noticia y explican muy detalladamente las
condiciones en las que se produce el falso positivo en la comprobación
de la contraseña. También he cambiado la <a href="http://twitter.com/hdmoore/status/211991006630002688" title="prueba de concepto">prueba de concepto</a> por la
de HD Moore porque me parece más elegante :)</p>
<hr />
<h2>Más información</h2>
<p>» <a href="http://bugs.launchpad.net/bugs/cve/2012-2122" title="CVE-2012-2122">CVE-2012-2122</a>
» <a href="http://seclists.org/oss-sec/2012/q2/493" title="Security vulnerability in MySQL/MariaDB sql/password.c">Security vulnerability in MySQL/MariaDB sql/password.c</a>
» <a href="http://unaaldia.hispasec.com/2012/06/mysql-o-como-es-posible-dar-por-valida.html" title="MySQL o cómo es posible dar por válida una contraseña incorrecta">MySQL o cómo es posible dar por válida una contraseña incorrecta</a></p>


            
            
            






            <hr/>
<section>
    <h2>Entradas relacionadas</h2>
<ul class="related-posts-list">
<li><a href="https://karpoke.ignaciocano.com/2012/05/13/kippo-probando-un-honeypot-en-ubuntu/" title="Kippo, probando un honeypot en Ubuntu">Kippo, probando un honeypot en Ubuntu</a></li>
<li><a href="https://karpoke.ignaciocano.com/2012/06/03/symfony-en-ubuntu-lucid-lynx-10-04/" title="Symfony en Ubuntu Lucid Lynx 10.04">Symfony en Ubuntu Lucid Lynx 10.04</a></li>
<li><a href="https://karpoke.ignaciocano.com/2012/08/02/de-usuarios-en-wordpress/" title="De usuarios en WordPress">De usuarios en WordPress</a></li>
<li><a href="https://karpoke.ignaciocano.com/2012/09/30/autenticacion-hardware-mediante-un-usb/" title="Autenticación hardware mediante un USB">Autenticación hardware mediante un USB</a></li>
<li><a href="https://karpoke.ignaciocano.com/2014/12/26/recuperar-el-sistema-tras-borrar-varlib/" title="Recuperar el sistema tras borrar «/var/lib»">Recuperar el sistema tras borrar «/var/lib»</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://karpoke.ignaciocano.com/2012/06/11/cde-creando-aplicaciones-portables-en-gnulinux/" title="Previous: CDE, creando aplicaciones portables en GNU/Linux">CDE, creando aplicaciones portables en GNU/Linux</a></li>
                <li class="next-article"><a href="https://karpoke.ignaciocano.com/2012/06/12/webmin-configurando-nuestro-servidor-a-traves-del-navegador/" title="Next: webmin, configurando nuestro servidor a través del navegador">webmin, configurando nuestro servidor a través del navegador</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2012-06-12T14:37:00+02:00">Jun 12, 2012</time>
            <h4>Category</h4>
            <a class="category-link" href="https://karpoke.ignaciocano.com/categorias/#hack-ref">hack</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#autenticacion-ref">autenticación
                    <span>2</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#mariadb-ref">mariadb
                    <span>1</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#mysql-ref">mysql
                    <span>12</span>
</a></li>
                <li><a href="https://karpoke.ignaciocano.com/etiquetas/#vulnerabilidades-ref">vulnerabilidades
                    <span>1</span>
</a></li>
            </ul>
<h4>Contacto</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/karpoke" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="/feeds/all/rss.xml" title="" target="_blank" rel="nofollow">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </div>
        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        2010-2019 (cc) Contenido bajo licencia <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/es/">Creative Commons Reconocimiento-CompartirIgual</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>